---
# tasks file for roles/master main
- name: Operating System configurations
  ansible.builtin.include_role:
    name: "{{ kubernetesConfigurations.operatingSystem }}"

- name: Launch master node
  ansible.builtin.include_role:
    name: kubernetes
    tasks_from: kubeadm.yml

- name: Apply kube configurations from remote and local
  ansible.builtin.include_role:
    name: kubernetes
    tasks_from: kubeConfig.yml

- name: Apply network element for the cluster
  ansible.builtin.include_role:
    name: kubernetes
    tasks_from: "{{ kubernetesConfigurations.networkElement }}.yml"

- name: Create dashboard and cluster role usser with permissions
  ansible.builtin.include_role:
    name: kubernetes
    tasks_from: dashboard.yml

- name: Apply metrics for the cluster
  ansible.builtin.include_role:
    name: kubernetes
    tasks_from: metrics.yml

- name: Deploy serverless functions
  ansible.builtin.include_role:
    name: fission
  when: kubernetesConfigurations.servelessFunctions | default(false) | bool

- name: Create secret for private Docker Registry
  ansible.builtin.include_role:
    name: kubernetes
    tasks_from: dockerRegistryCreateSecret

- name: Create Join Script for Client
  ansible.builtin.include_role:
    name: kubernetes
    tasks_from: joinCommand.yml

- name: Remove extra label from node
  ansible.builtin.include_role: 
    name: kubernetes
    tasks_from: kubernetesRoleLabels
